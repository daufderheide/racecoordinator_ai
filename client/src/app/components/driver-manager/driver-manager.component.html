<div class="dm-container" [style.transform]="'translate(-50%, -50%) scale(' + scale + ')'">
  <div class="dm-header">
    <app-back-button [label]="'DM_BTN_BACK' | translate"></app-back-button>
  </div>

  <div class="main-content">
    <!-- LEFT PANEL: DRIVERS TABLE -->
    <div class="panel list-panel">
      <div class="panel-header">
        <div class="panel-title">{{ 'DM_HEADER_DRIVERS' | translate }}</div>
        <div class="search-container">
          <input type="text" [placeholder]="'DM_PLACEHOLDER_SEARCH' | translate" [(ngModel)]="searchQuery"
            class="search-input">
        </div>
      </div>
      <div class="table-header-fixed">
        <table class="driver-table header-only">
          <thead>
            <tr>
              <th class="col-avatar">{{ 'DM_COL_AVATAR' | translate }}</th>
              <th class="col-name">{{ 'DM_COL_NAME' | translate }}</th>
              <th class="col-nickname">{{ 'DM_COL_NICKNAME' | translate }}</th>
            </tr>
          </thead>
        </table>
      </div>
      <div class="table-body-scroll">
        <table class="driver-table body-only">
          <tbody>
            <tr *ngFor="let driver of filteredDrivers; trackBy: trackByDriver"
              [class.active]="selectedDriver?.entity_id === driver.entity_id" (click)="selectDriver(driver)">
              <td class="avatar-cell col-avatar">
                <div class="avatar-mini">
                  <img [src]="driver.avatarUrl | avatarUrl" alt="Avatar">
                </div>
              </td>
              <td class="name-cell col-name">{{ driver.name }}</td>
              <td class="nickname-cell col-nickname">{{ driver.nickname }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- RIGHT PANEL: CONFIGURATION -->
    <div class="panel config-panel">
      <div class="avatar-preview-container" *ngIf="editingDriver">
        <div class="avatar-preview-large">
          <img [src]="editingDriver.avatarUrl | avatarUrl" alt="Avatar Large">
        </div>
      </div>

      <div class="config-header">{{ 'DM_HEADER_CONFIG' | translate }}</div>

      <div class="config-form" *ngIf="editingDriver">
        <div class="form-group">
          <label>{{ 'DM_LABEL_NAME' | translate }}</label>
          <input type="text" [(ngModel)]="editingDriver.name" class="dm-input" readonly>
        </div>

        <div class="form-group">
          <label>{{ 'DM_LABEL_NICKNAME' | translate }}</label>
          <input type="text" [(ngModel)]="editingDriver.nickname" class="dm-input" readonly>
        </div>

        <div class="action-buttons">
          <button class="btn btn-edit" (click)="updateDriver()">{{ 'DM_BTN_EDIT' | translate }}</button>
          <button class="btn btn-delete" (click)="deleteDriver()">{{ 'DM_BTN_DELETE' | translate }}</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Connection Lost Overlay -->
  <div class="connection-lost-overlay" *ngIf="isConnectionLost">
    <div class="connection-spinner"></div>
    <div class="connection-lost-text">{{ 'DM_LOST_CONNECTION' | translate }}</div>
  </div>

  <!-- Loading Overlay -->
  <div class="loader-overlay" *ngIf="isLoading || isSaving">
    <div class="spinner"></div>
  </div>
</div>