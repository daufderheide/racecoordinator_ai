syntax = "proto3";
package com.antigravity;

import "client/track_model.proto";
import "client/model.proto";

option java_package = "com.antigravity.proto";
option java_multiple_files = true;
option java_outer_classname = "RaceModelProto";

message HeatScoring {
  enum FinishMethod {
    Lap = 0;
    Timed = 1;
  }

  enum HeatRanking {
    HR_LAP_COUNT = 0;
    HR_FASTEST_LAP = 1;
    HR_TOTAL_TIME = 2;
  }

  enum HeatRankingTiebreaker {
    HRT_FASTEST_LAP_TIME = 0;
    HRT_MEDIAN_LAP_TIME = 1;
    HRT_AVERAGE_LAP_TIME = 2;
  }

  enum AllowFinish {
    AF_NONE = 0;
    AF_ALLOW = 1;
    AF_SINGLE_LAP = 2;
  }

  FinishMethod finish_method = 1;
  int64 finish_value = 2;
  HeatRanking heat_ranking = 3;
  HeatRankingTiebreaker heat_ranking_tiebreaker = 4;
  AllowFinish allow_finish = 5;
}

message OverallScoring {
  enum OverallRanking {
    OR_LAP_COUNT = 0;
    OR_FASTEST_LAP = 1;
    OR_TOTAL_TIME = 2;
    OR_AVERAGE_LAP = 3;
  }

  enum OverallRankingTiebreaker {
    ORT_FASTEST_LAP_TIME = 0;
    ORT_MEDIAN_LAP_TIME = 1;
    ORT_AVERAGE_LAP_TIME = 2;
    ORT_TOTAL_TIME = 3;
  }

  int32 dropped_heats = 1;
  OverallRanking ranking_method = 2;
  OverallRankingTiebreaker tiebreaker = 3;
}

message RaceModel {
  Model model = 1;
  string name = 2;
  TrackModel track = 3;
  HeatScoring heat_scoring = 4;
  OverallScoring overall_scoring = 5;
  double min_lap_time = 6;
  AnalogFuelOptions fuel_options = 7;
}

enum FuelUsageType {
  LINEAR = 0;
  QUADRATIC = 1;
  CUBIC = 2;
}

message AnalogFuelOptions {
  bool enabled = 1;
  bool reset_fuel_at_heat_start = 2;
  bool end_heat_on_out_of_fuel = 3;
  double capacity = 4;
  FuelUsageType usage_type = 5;
  double usage_rate = 6;
  double start_level = 7;
  double refuel_rate = 8;
  double pit_stop_delay = 9;
}

